# 广电-微信-接口

## 接口规范

所有请求均需带上openid参数

所有响应内容都有result参数,result=success表示执行成功,否则会返回message描述异常信息.
所有响应内容中表示时间的数据统一返回毫秒级时间戳


## 基础服务

#### 获取token

请求方式: GET /wechat/accesstoken

请求参数:

```

```

响应内容:

```json
{
    "result": "success",
    "token": "adbc...",
    "ticket": "123...."
}
```

#### 接口名称: 扫码

请求方式: GET /wechat/qrcode?key=xxx

接口描述:

```
返回当前项目支持的环境调节项目
```

请求参数:

```
key=xxx
```

响应内容:

```
{
    "result": "success"
    "projectId": "",  # 项目id
    "regionId": "",   # 区域id
    "spaceId": ""     # 空间id
}
```

#### 接口名称: 查找建筑

请求方式: GET /wechat/building

接口描述:

```
根据gps定位，符合500m范围内的最近的一个建筑
```

请求参数:

```

```

响应内容:

```
{
    "result": "success"
    "buildings":[              
        {
            "id": "",  # 建筑id
            "name": ""   # 建筑名称     
            "longitude": "",
            "latitude": "",
            "distance": 500 # 500米内可以报修
        }
    ]
}
```

####  

## 登录与登出

#### 接口名称: 查询当前登录状态

请求方式: GET /wechat/login/status?optnId=xxx

请求参数:

```

```

响应内容:

```
{
    "result": "success"
    "logined": true         # true: 已登录 false: 未登录
}
```



#### 接口名称:获取验证码

请求方式: GET /wechat/smscode

请求参数:

```

```

响应内容:

```
{
    "result": "success" # 发送成功
}
```

#### 接口名称:登录

请求方式: POST /wechat/login

请求参数:

```
{
    "phoneNumber": "",
    "smsCode": ""
}
```

响应内容:

```
{
    "result": "success" # 登录成功
}
```

#### 接口名称:登出

请求方式: POST /wechat/logout

请求参数:

```

```

响应内容:

```
{
    "result": "success"
}
```



## 环境调节

#### 接口名称: 当前房间信息

请求方式: GET/wechat/roomInfo

接口描述:

```
查询当前已登录用户的房间信息
```

请求参数:

```

```

响应内容:

```
{
    "result": "success",
    "roomInfo": {           # 房间信息
    	"id": "room id",
    	"name": "room name"
    }
}
```



#### 接口名称: 当前房间环境
请求方式: GET /wechat/environment

接口描述:

```
返回当前房间的环境数据
```

请求参数:

```

```

响应内容:

```json
{
    "result": "success"
    "currentTemperature": 10.5,  # 当前温度
    "currentPm25": 291, # 当前pm2.5
    "currentCo2": 600, # 当前co2浓度
    "currenthumidity": 23, # 当前湿度
    "targetTemperature": "22",      # 设定温度
    "weatherInfo": { # 天气
    	"weather": "多云转阴",
    	"low": 4,
    	"high": 19
    }
}
```

#### 接口名称: 当前项目环境调节项目
请求方式: GET /wechat/feedback/item

接口描述:

```
返回当前项目支持的环境调节项目
```

请求参数:

```

```

响应内容:

```
{
    "result": "success"
    "items": [
        {
        	"id": 1, 
        	"name": "有点冷"
        }
    ],
    "exactTempretureSupport": true # 是否支持精确调节
}
```

#### 接口名称: 调节环境

请求方式: POST /wechat/feedback

接口描述:

```

```

请求参数:

```
{
    "itemId: 1,  
    "exactTempreture": 25    # itemId和exactTempreture 二选一 
}
```

响应内容:

```
{

}
```

## 客房服务

#### 接口名称: 可用的客房服务项目

请求方式: GET /wechat/roomservice

接口描述:

```
返回当前项目可用的客服服务
```

请求参数:

```

```

响应内容:

```
{
    "result": "success"
    "services": [
        {"id": 1, "name: "客房清洁"},
        {"id": 2, "name: "客房用品"},
        {"id": 3, "name: "洗衣服务"},
        {"id": 4, "name: "订餐服务"},
        {"id": 5, "name: "行李寄存"},
        {"id": 6, "name: "预约送机"},
        {"id": 7, "name: "叫醒服务"},
        {"id": 8, "name: "会议室预定"}

    ]
}
```

#### 接口名称:客房清洁

请求方式: POST /wechat/roomservice/create

接口描述:

```
提交客房清洁
```

请求参数:

```
{
	"id": 1,
    "startDate": "yyyyMMdd",
    "startTime": "HHmm",
    "remark": "备注"
}
```

响应内容:

```
{
    "result": "success"
}
```

#### 接口名称:客房用品

请求方式: POST /wechat/roomservice/create

接口描述:

```
提交客房清洁
```

请求参数:

```
{
	"id": 2,
    "startDate": "yyyyMMdd",
    "startTime": "HHmm",
    "remark": "备注"
}
```

响应内容:

```
{
    "result": "success"
}
```

#### 接口名称:洗衣服务

请求方式: POST /wechat/roomservice/create

接口描述:

```
提交客房清洁
```

请求参数:

```
{
	"id": 3,
    "startDate": "yyyyMMdd",
    "startTime": "HHmm",
    "remark": "备注"
}
```

响应内容:

```
{
    "result": "success"
}
```

#### 接口名称:行李寄存

请求方式: POST /wechat/roomservice/create

接口描述:

```
提交客房清洁
```

请求参数:

```
{
	"id": 5,
    "startDate": "yyyyMMdd",
    "startTime": "HHmm",
    "endDate": "yyyyMMdd",
    "endTime": "HHmm",
    "remark": "备注"
}
```

响应内容:

```
{
    "result": "success"
}
```

#### 接口名称:预约送机

请求方式: POST /wechat/roomservice/create

接口描述:

```
提交客房清洁
```

请求参数:

```
{
	"id": 6,
    "startDate": "yyyyMMdd",
    "startTime": "HHmm",
    "remark": "备注"
}
```

响应内容:

```
{
    "result": "success"
}
```

#### 接口名称:叫醒服务

请求方式: POST /wechat/roomservice/create

接口描述:

```
提交客房清洁
```

请求参数:

```
{
	"id": 7,
	"serviceType": ["tel"], # tel:房间电话, phone: 手机
    "startDate": "yyyyMMdd",
    "startTime": "HHmm",
    "remark": "备注"
}
```

响应内容:

```
{
    "result": "success"
}
```

## 报修

#### 空间列表

请求方式: GET /wechat/regions

请求参数:

```
projectId: xxx #建筑id
```

响应内容:

```json
{
    "result": "success",
    "data": [
    	{
    		"id":"xx",
    		"name": "4层",
    		"spaces":[
                {
                    "id": "roomid",
                    "name": "401"
                }
    		]
    	}
    ]
}
```



#### 报修问题类型

请求方式: GET /wechat/repairitems

请求参数:

```

```

响应内容:

```json
{
    "result": "success",
    "data": [
        {
			"id": "xxx",
			"name": "电器",
			"items": [
                {
                    "sopId": "xxx",
                    "sopName": "电器"
                }
            ]
        }
    ]
}
```



#### 报修

请求方式: POST /wechat/repair

请求参数:

```
{
    "spaceId": "xxxx",
    "sopId": "xxxx",
    "sopName": "电器",
    "phone": "13222221111",
    "remark": "备注",
    "descPhotos": ["图片地址1","图片地址2"]
}
```

响应内容:

```json
{
    "result": "success"
}
```

#### 报修记录   返回修改，同工单查询

请求方式: GET /wechat/repair/record

请求参数:

```
"openId": "xxxx",
"type": "finished",
"page": 1,
"size": 10
```

响应内容:

```json
{
    "result": "success",
    "data": [
        {
            "orderId": "",
            "orderName": "",
            "projectId": "",
            "projectName": "",
            "statusId": "",
            "statusName": "",
            "createTime": ""
        }
    ]
}


```



#### 报修详情

请求方式: GET /wechat/repair/detail

请求参数:

```
"orderId": "xxxx"
```

响应内容:

```json
{
    "result": "success",
    "orderId": "",
    "orderName": "",
    "projectId": "",
    "projectName": "",
    "statusId": "",
    "statusName": "",
    "createTime": "",
    ...
}
```

#### 报修评价

请求方式: POST /wechat/repair/evaluate

请求参数:

```
{
    "orderId": "XXX",
    "quality": 5,
    "attitude": 5,
    "speed": 5,
    "content": "xxx"
}
```

响应内容:

```json
{
    "result": "success"
}
```









## 其他接口

#### 洗衣服务价目表

请求方式: GET /wechat/laundry/prices

请求参数:

```

```

响应内容:

```json
{
    "result": "success",
    "data": [
        {
            "type": "overcoat",
            "name": "大衣物",
            "prices": [{
                "type": "downcoat",
                "name": "羽绒服",
                "price": 30
            }]

        }
    ]
}
```

## 