# 微信号-慧云盈业主版功能  

## 接口规范

所有请求均需带上openid参数

所有响应内容都有result参数,result=success表示执行成功,否则会返回message描述异常信息.所有响应内容中表示时间的数据统一返回毫秒级时间戳

## 基础服务

#### 获取token

请求方式: GET /wechat/accesstoken

请求参数:

```

```

响应内容:

```
{
 "result": "success",
"token": "adbc...",
"ticket": "123...."
}
```

## 登录与登出

#### 接口名称: 查询当前登录状态

请求方式: GET /wechat/login/status?optnId=xxx

请求参数:

## 登录与登出

#### 接口名称: 查询当前登录状态

请求方式: GET /wechat/login/status?optnId=xxx

请求参数:

```

```

响应内容: 

```
{
    "result": "success"
    "logined": true         # true: 已登录 false: 未登录
}
```

#### 接口名称:登录

请求方式: POST /wechat/login

请求参数:

```
{
    "emailUser": "",
    "passWord": ""
}
```

响应内容:

```
{
    "result": "success" # 登录成功
}
```

#### 接口名称:登出

请求方式: POST /wechat/logout

请求参数:

```
{
    "emailUser": "",
    "passWord": ""
}
```

响应内容:

```
{
    "result": "success"
}
```

#### 接口名称：首页

请求方式：POST /wechat/indexPage

请求参数：

```

```

响应内容：

```
{
    "result": "success",
    "data": {           # 主体信息
    	"title":{  #头部显示个数
            "id": 1, id: 2, id: 4
    	},
    	"environment": {
            "grade": "95", #分数
            "temperature": "", #温度
            "outTemperature": "", #室外温度
            "humidity": "", #湿度
            "outHumidity": "",#室外湿度
            "CO2": "", # CO2
            "outCO2": "",#室外co2
            "PM25": "",#室外pm2.5
            "outPM25": "",#室外pm2.5
    	},
    	"system":{
            "grade": "",#分数
            "todayQue": "", #今日问题解决数
            "allQue": "", #解决问题总量
            "totalTime": "", #累计监测时间
    	},
    	  "cost": {
            "exceed": "",#1未超出成本，2有超出的趋势，3已超出成本
            "budget": "",#成本红线
            "data":[
                {
                    "x": 1,      # 横坐标
                    "y": 12,     # 纵坐标
                    "attr1": true,  # 是否超出, 超出显示红色
                    "attr2": true   # 是否预测, 预测显示虚线
                }
            ]
      },
    	"deposit": {
            "grade": "",#分数
            "todayOrder": "",#今日完成工单
            "totalOrder": "",#累计完成工单
    	}
    }
}
```

## 环境监测

#### 接口名称:环境头部

请求方式: POST /wechat/environ/title

请求参数：

```

```

响应参数：

```json
{
    
}
```

```
{
    "result": "succcess",
    "data": {
        "id": 1, "id": 2, "id": 4
    }
}
```

#### 接口名称:环境表格

请求方式: POST /wechat/environ/echart

请求参数：

```

```

响应参数：

```
{
        'result': 'success',
        "data": {
            "echartsData": [
                {
                    "yAxios1": number,#第一个y轴数据
                    "yAxios2": number,#第二个y轴数据
                    "date": yyyy-MM-dd,#x轴
                },
                ...
            ],
            "unmet":[
                {
                    floorName: string,#楼层名称
                    spaceName: string, #空间名称
                    spaceId: number, #空间id
                }
                ...
            ]
        }
}
```

## 系统监测

#### 接口名称：系统监测

请求方式: POST /wechat/system

请求参数：

```

```

响应参数：

```
{
    "result": "success",
    "data": {
    	"detected": [
            {
                "id": "xxx",
                "name": "xxx",
                "grade": number,#分数
                "todayQue": number, #今日问题解决数
                "allQue": number, #解决问题总量,
                "totalHours": 30000, # 累计监控时间,单位小时
            }
    	]
        "undetected": [
          {
                "id": "xxx",
                "name": "xxx",
          },
          ...
        ]
    }
}
```



## 成本管理

#### 接口名称：成本管理

请求方式：POST /wechat/cost

请求参数：

```

```

相应参数：

```
{
    "result": "success",
    "data": {
        "echats":{
            "exceed": "",#1未超出成本，2有超出的趋势，3已超出成本
            "budget": "",#成本红线
            "data":[
                {
                    "x": 1,      # 横坐标
                    "y": 12,     # 纵坐标
                    "attr1": true,  # 是否超出, 超出显示红色
                    "attr2": true   # 是否预测, 预测显示虚线
                },
                ...
            ]
      	},
      	"costItem": [
            {
                "key": string,#成本分项名
                "value": number,#成本分项的值
            },
            ...
      	]
    }
}
```

## 服务定制

### 服务定制首页：

#### 接口名称： 服务定制首页

请求方式: POST /wechat/customization/index

请求参数：

```

```

响应参数：

```
{
    "result": "success",
    "data": {
        "cost":{
            "process": string,#处理方式
            "processDate": yyyy-MM-DD,#修改超限处理方式日期
            "costDate": yyyy-MM-DD,#修改成本红线的日期
        },
        "environ":{
            "minimum": number,#满足下限
        }
    }
}
```

### 添加使用时间、历史记录页

#### 接口名称：生效、即将生效和历史记录

请求方式: POST /wechat/customization/addUseTime

请求参数：

```
{
    type: 0 #0生效 1即将生效 3历史记录
}
```

响应参数：

```
{
    "result": "success",
    "data": {
        list: [
            {
                title: String, #文本备注title
                placeArr: ['place1','place2'], #地址数组
                startTime: '',#生效开始时间
                endTime: '',#生效结束时间
                listId: '',#该使用时间id
            }
        ]
    }
}
```



#### 接口名称：停止生效/取消生效

请求方式：POST/wechat/customization/del

请求参数

```
{
    type: '',#o生效中1即将生效
    listId: '',#停止的id
}
```

返回参数：

```
{
    result: 'success'
}
```

### 选择生效时间文案页

#### 接口名称：所用空间所用分组

请求方式：GET/wechat/customization/all_space

请求参数：

```
{
    
}
```

响应参数：

```
{
    result: 'success',
    data: {
        spaceList: [
            {
                key: '',#spaceId
                value: '',#spaceName
            }
        ]
    }
}
```

#### 接口名称：新建空调使用时间

请求方式：POST/wechat/customization/create_time

请求参数：

```
{
    cause: string,#使用原因
    spaceArr: [],spaceId数组
    startTime: '',开始时间
    endTime: '',结束时间
    timeArr: [
        {
            startTime: '',
            endTime: '',
        },
        ...
    ]
}
```

响应参数：

```
{
    result: 'success',
    data: {
    }
}
```

### 修改成本红线页

#### 接口名称：获取优先保障列表

请求方式： GET/wechat/customization/getSafeList

请求参数：

```

```

响应参数：

```
{
    result: '',
    data: {
        list: [
            {
                key: string,#处理方式的名字
                value: string,#处理方式的id
            },
            ...
        ]
    }
}
```

#### 接口名称：保存

请求方式： POST/wechat/customization/setCostSafe

请求参数：

```
{
    id: ''
}
```

响应参数：

```

```



### 设定全楼温度满足率下限页

#### 接口名称：获取房间总数、满足房间和满足率

请求方式： GET/wechat/customization/getRateSet

请求参数：

```
{
    
}
```

响应参数：

```
{
    result: '',
    data: {
        roomNum: number,#房间总数
        rate: number,#满足率
    }
}
```

#### 接口名称：保存房间总数、满足房间和满足率

请求方式： POST/wechat/customization/setRateSet

请求参数：

```
{
    roomNum: number,#房间总数
    rate: number,#满足率
}
```

响应参数：

```

```

## 建议页

#### 接口名称：建议请求

请求方式： POST/wechat/suggest

请求参数：

```
{
    note: string,#反馈内容
    phone: number,#手机号
    imgList:[]#图片List
}
```

## 个人页

#### 接口名称：获取个人数据

请求方式： GET/wechat/user

请求参数：

```

```

响应参数：

```
{
    result: '',
    data: {
        email: '',
        pic: ''
    },
    resMsg: ''
}
```

## 搜索页

#### 接口名称： 获取建筑、楼层

请求方式：GET/wechat/search/build

请求参数：

```

```

响应参数：

```
{
    result: '',
    resMsg: '',
    data: {
        build:[{
            "code":"",
            "build":"",
            "content":[{
                "floor":"",
                "code":"",
            }]
        }],
    }
}
```

#### 接口名称： 获取专业、系统和设备类

请求方式：POST/wechat/search/system

请求参数：

```
{
    build: '',
    floor: ''
}
```

响应参数：

```
{
    result: '',
    resMsg: '',
    data: {
        content: [
        	{
            	"code":"SE",
            	"class":"强电专业",
            	"content":[
                	{
                    	"system":"变配电系统",
                    	"code":"TD",
                    	"content":[
                        	{
                            	"code":"TDTF",
                            	"facility":"变压器"
                        	}
                     	]
                 	}
                 ]
            }
        ]
    }
}
```

#### 接口名称：搜索设备类

请求方式：POST/wechat/search/equip

请求参数：

```
{
    build: '',
    floor: '',
    class: '',
    system: '',
    facility: ''
}
```

响应参数：

```
{
    result: '',
    resMsg: '',
    data: {
        list: [
            {
            	id: '',
                equipName: '',
                equipCode: ''
            }
        ]
    }
}
```

#### 接口名称：系统详情

请求方式：POST/wechat/system/details

请求参数：

```
{
    id: ''
}
```

响应参数：

```
{
    result: '',
    resMsg: '',
    data: {
        content: [
            {
                label: '',
                value: '',
                "firstTag":"",              //String，一级标签
            	"secondTag":"",             //String，二级标签
            	"infoPointName":"项目ID",   //String，信息点名称
            	"infoPointCode":"ProjID",   //String，信息点编码
            	"unit":"",                  //String，计量单位
            	"dataType":"Str",           //String，数据类型
            	"inputMode":"X",            //String，输入模式
            	"dataSource":"",            //String或JSONArray，字典选择
            	"note":"",                  //String，备注
            	"func-id":"",               //String，表号-功能号
            	"classification":"1"        //String，信息点所属类别，可没有该字段
            }
        ],
        state: '', //运行状态 0,运行中；1维修中
        isMonitor: '',//是否接入监测 0,未接入；1已接入
        sysNum: '',//存在于此设备下的设备数量
        sysCode: '',//该系统的code
        sysTime: '',//该系统监测的时长
    }
}
```

#### 接口名称： 设备详情

请求方式： POST/wechat/facility/details

请求参数：

```
{
    id: ''
}
```

响应参数：

```
{
    result: '',
    resMsg: '',
    data: {
        content: [
            {
                label: '',
                value: '',
                "firstTag":"",              //String，一级标签
            	"secondTag":"",             //String，二级标签
            	"infoPointName":"项目ID",   //String，信息点名称
            	"infoPointCode":"ProjID",   //String，信息点编码
            	"unit":"",                  //String，计量单位
            	"dataType":"Str",           //String，数据类型
            	"inputMode":"X",            //String，输入模式
            	"dataSource":"",            //String或JSONArray，字典选择
            	"note":"",                  //String，备注
            	"func-id":"",               //String，表号-功能号
            	"classification":"1"        //String，信息点所属类别，可没有该字段
            }
        ],
        state: '',//运行状态 0,运行中；1维修中
    }
}
```

#### 接口名称：查找空间

请求方式：POST/wechat/search/space

请求参数：

```
{
    result: '',
    resMsg: '',
    data: {
        list: [
            {
            	id: '',
                spaceName: '',
               	spaceCode: ''
            },
            ...
        ]
    }
}
```

#### 接口名称：空间详情

请求方式：POST/environ/spaceDetails

请求参数：

```
{
    id: ''
}
```

响应参数：

```
{
    result: '',
    resMsg: '',
    data: {
        temp: '',//温度
        humidity: '',//湿度
        pm25: '',//pm2.5
        co2: '',//co2
        echats:[
            {
            	fact: "25", 
            	time: "173000", 
            	value: "22.0,26.0"
            }
        ]
    }
}
```

